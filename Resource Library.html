<!DOCTYPE html>
<html lang="th">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QJBKDWWT2P"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-QJBKDWWT2P');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Resource Library - คลังสื่อการสอน</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { heading: ['Prompt', 'sans-serif'], body: ['Sarabun', 'sans-serif'] },
                    colors: { brand: '#0071e3', bg: '#F5F5F7' },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F5F5F7; -webkit-tap-highlight-color: transparent; }
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .resource-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .resource-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.1); }
        .cat-btn.active { background-color: #1d1d1f; color: white; border-color: #1d1d1f; }
        
        /* Hide Scrollbar */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        /* Nav Icon Animation */
        .nav-icon { transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        .active-nav .nav-icon { transform: translateY(-5px); color: #0071e3; }
        .active-nav span { color: #0071e3; font-weight: 600; }
    </style>
</head>
<body class="font-body text-gray-800 pb-28 pt-20">

    <!-- Navbar -->
    <nav class="glass-nav fixed top-0 w-full z-40 px-4 md:px-8 py-3 flex justify-between items-center h-16 transition-all duration-300">
        <div class="flex items-center gap-4 overflow-hidden">
            <a href="Main_Dashboard.html" class="w-10 h-10 rounded-full bg-white border border-gray-200 flex-shrink-0 flex items-center justify-center hover:bg-gray-100 transition shadow-sm active:scale-95">
                <i class="fa-solid fa-arrow-left text-gray-600"></i>
            </a>
            <div class="truncate">
                <h1 class="font-heading text-lg font-bold text-gray-900 truncate hidden sm:block">คลังสื่อการสอน <span class="text-brand text-xs font-normal bg-blue-50 px-2 py-0.5 rounded-full ml-2">Online Feed</span></h1>
                <h1 class="font-heading text-lg font-bold text-gray-900 truncate sm:hidden">คลังสื่อ</h1>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="flex-1 max-w-lg mx-4 hidden sm:block">
            <div class="relative group">
                <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-brand transition"></i>
                <input type="text" id="searchInput" onkeyup="filterContent()" placeholder="ค้นหาสื่อ, วิดีโอ, ใบงาน..." class="w-full bg-white border border-gray-200 rounded-full py-2 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-brand/50 transition shadow-sm">
            </div>
        </div>

        <!-- Mobile Search Toggle & Upload -->
        <div class="flex items-center gap-2 sm:gap-3">
            <button class="sm:hidden w-10 h-10 rounded-full bg-white border border-gray-200 flex items-center justify-center text-gray-600 shadow-sm active:scale-95" onclick="document.getElementById('mobile-search').classList.toggle('hidden')">
                <i class="fa-solid fa-magnifying-glass"></i>
            </button>
            <button onclick="toggleUploadModal()" class="bg-gray-900 text-white px-4 py-2 rounded-full text-xs font-bold shadow-lg hover:bg-black transition flex items-center gap-2 active:scale-95">
                <i class="fa-solid fa-cloud-arrow-up"></i> <span class="hidden sm:inline">อัปโหลด</span>
            </button>
        </div>
    </nav>

    <!-- Mobile Search Bar (Expandable) -->
    <div id="mobile-search" class="fixed top-16 left-0 w-full bg-white p-3 z-30 shadow-sm hidden sm:hidden animate-fade-in">
        <div class="relative">
            <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <input type="text" onkeyup="filterContent()" placeholder="ค้นหา..." class="w-full bg-gray-50 border border-gray-200 rounded-full py-2 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-brand/50">
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto mt-4 sm:mt-8 px-4 md:px-8">

        <!-- 1. Dynamic Featured Section (Online Feed) -->
        <div id="featured-container" class="mb-8 animate-fade-in min-h-[250px] sm:min-h-[300px] relative">
            <div class="absolute inset-0 bg-gray-200 rounded-3xl animate-pulse"></div> <!-- Skeleton -->
            
            <!-- Content -->
            <div id="featured-content" class="relative hidden">
                <div class="bg-gradient-to-br from-[#0f172a] via-[#1e293b] to-[#334155] rounded-3xl p-6 md:p-10 text-white relative overflow-hidden shadow-2xl group flex flex-col md:flex-row items-center gap-6 md:gap-10">
                    
                    <!-- Background Effects -->
                    <div class="absolute top-0 right-0 w-[300px] md:w-[500px] h-[300px] md:h-[500px] bg-brand opacity-20 rounded-full blur-[80px] md:blur-[100px] -mr-20 -mt-20 animate-pulse-slow"></div>
                    <img id="feat-bg" src="" class="absolute inset-0 w-full h-full object-cover opacity-10 mix-blend-overlay transition duration-700 group-hover:scale-105">

                    <!-- Text Content -->
                    <div class="w-full md:w-3/5 space-y-4 relative z-10 text-center md:text-left order-2 md:order-1">
                        <div class="flex items-center justify-center md:justify-start gap-2 flex-wrap">
                            <span class="bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wider flex items-center gap-1">
                                <i class="fa-brands fa-youtube"></i> Recommended
                            </span>
                            <span id="feat-source" class="text-xs text-gray-300 font-medium border border-white/20 px-2 py-0.5 rounded-full">Source: ALTV</span>
                        </div>
                        
                        <h2 id="feat-title" class="text-xl md:text-4xl font-heading font-bold leading-tight drop-shadow-lg line-clamp-2">Loading...</h2>
                        <p id="feat-desc" class="text-gray-300 text-xs md:text-base line-clamp-2 font-light">...</p>
                        
                        <div class="flex justify-center md:justify-start gap-3 pt-2">
                            <button onclick="playFeaturedVideo()" class="bg-white text-gray-900 px-5 py-2.5 rounded-xl font-bold hover:bg-gray-100 hover:scale-105 active:scale-95 transition flex items-center gap-2 shadow-lg shadow-white/10 text-sm">
                                <i class="fa-solid fa-play text-brand"></i> รับชม
                            </button>
                            <button onclick="refreshFeatured()" class="bg-white/10 text-white px-4 py-2.5 rounded-xl font-bold hover:bg-white/20 active:scale-95 transition backdrop-blur-sm" title="สุ่มเรื่องใหม่">
                                <i class="fa-solid fa-shuffle"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Thumbnail Card -->
                    <div class="w-full md:w-2/5 aspect-video rounded-2xl overflow-hidden shadow-2xl border-4 border-white/10 relative group cursor-pointer order-1 md:order-2" onclick="playFeaturedVideo()">
                        <img id="feat-img" src="" class="w-full h-full object-cover transition duration-500 group-hover:opacity-80">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-red-600/90 backdrop-blur-sm flex items-center justify-center text-white shadow-xl scale-90 group-hover:scale-110 transition duration-300">
                                <i class="fa-solid fa-play text-xl md:text-2xl pl-1"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Filter Tabs (Scrollable) -->
        <div class="sticky top-[60px] z-20 bg-[#F5F5F7]/95 backdrop-blur-sm py-2 -mx-4 px-4 md:mx-0 md:px-0 mb-4 transition-all">
            <div class="flex gap-2 overflow-x-auto w-full scrollbar-hide pb-1">
                <button onclick="filterCat('all')" class="cat-btn active px-4 py-1.5 rounded-full border border-gray-300 bg-white text-sm font-medium text-gray-600 whitespace-nowrap hover:border-gray-400 active:scale-95 transition">ทั้งหมด</button>
                <button onclick="filterCat('video')" class="cat-btn px-4 py-1.5 rounded-full border border-gray-300 bg-white text-sm font-medium text-gray-600 whitespace-nowrap hover:border-gray-400 active:scale-95 transition"><i class="fa-brands fa-youtube mr-1 text-red-500"></i> วิดีโอ</button>
                <button onclick="filterCat('worksheet')" class="cat-btn px-4 py-1.5 rounded-full border border-gray-300 bg-white text-sm font-medium text-gray-600 whitespace-nowrap hover:border-gray-400 active:scale-95 transition"><i class="fa-solid fa-file-pdf mr-1 text-orange-500"></i> ใบงาน</button>
                <button onclick="filterCat('exam')" class="cat-btn px-4 py-1.5 rounded-full border border-gray-300 bg-white text-sm font-medium text-gray-600 whitespace-nowrap hover:border-gray-400 active:scale-95 transition"><i class="fa-solid fa-clipboard-question mr-1 text-purple-500"></i> ข้อสอบ</button>
            </div>
        </div>
        
        <div class="text-xs text-gray-400 mb-4 px-1">
            พบสื่อการสอน <span id="count-display" class="font-bold text-gray-800">0</span> รายการ
        </div>

        <!-- 3. Local Resource Grid (Responsive) -->
        <div id="resource-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
            <!-- Items injected by JS -->
        </div>

    </div>

    <!-- Video Modal (Youtube Embed) -->
    <div id="video-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-0 md:p-4 bg-black/90 backdrop-blur-md">
        <div class="relative w-full md:max-w-4xl h-full md:h-auto aspect-video bg-black md:rounded-2xl overflow-hidden shadow-2xl flex items-center">
            <button onclick="closeVideoModal()" class="absolute top-4 right-4 z-10 w-10 h-10 bg-black/50 hover:bg-black/80 text-white rounded-full flex items-center justify-center transition">
                <i class="fa-solid fa-xmark"></i>
            </button>
            <iframe id="youtube-frame" class="w-full aspect-video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>

    <!-- Upload Modal -->
    <div id="upload-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 relative transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-heading font-bold text-lg">อัปโหลดสื่อการสอน</h3>
                <button onclick="toggleUploadModal()" class="text-gray-400 hover:text-gray-600"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-gray-50 transition cursor-pointer mb-4 active:scale-95 relative group">
                <input type="file" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">
                <i class="fa-solid fa-cloud-arrow-up text-4xl text-brand mb-2 group-hover:scale-110 transition"></i>
                <p class="text-sm text-gray-600">ลากไฟล์มาวางที่นี่ (PDF, PPT)</p>
            </div>
            <button onclick="alert('อัปโหลดเรียบร้อย (จำลอง)'); toggleUploadModal();" class="w-full py-3 bg-gray-900 text-white rounded-xl font-bold shadow hover:bg-black active:scale-95 transition">บันทึก</button>
        </div>
    </div>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-xl border-t border-gray-200 px-4 py-2 md:hidden z-50 rounded-t-2xl shadow-[0_-5px_10px_rgba(0,0,0,0.02)]">
        <div class="relative flex justify-between items-center max-w-sm mx-auto">
            <div id="nav-pill" class="absolute top-1/2 -translate-y-1/2 h-10 w-12 bg-blue-50 rounded-xl transition-all duration-300 ease-out -z-10"></div>
            <a href="Main_Dashboard.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="0"><i class="fa-solid fa-house text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">หน้าหลัก</span></a>
            <a href="LessonPlan_Manager.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="1"><i class="fa-solid fa-book-open text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">แผนการ</span></a>
            <a href="Classroom Manager.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="2"><i class="fa-solid fa-users text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">ชั้นเรียน</span></a>
            <a href="Resource Library.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400 active-nav" data-index="3"><i class="fa-solid fa-photo-film text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">คลังสื่อ</span></a>
            <a href="TeacherPortfolio_BentoGrid.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="4"><i class="fa-solid fa-user text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">ข้อมูล</span></a>
        </div>
    </nav>

    <script>
        // --- 1. Real Online Sources Data ---
        const onlineResources = [
            { id: 'h7uX3f7s1gE', title: 'สรุปวิทย์ ม.ต้น : ระบบร่างกายมนุษย์', channel: 'Mahidol Kids', cat: 'วิทยาศาสตร์', views: '1.2M' },
            { id: 'Q5_5aK4yqYc', title: 'ติว O-NET ภาษาอังกฤษ ม.3', channel: 'ALTV ช่อง 4', cat: 'ภาษาอังกฤษ', views: '450K' },
            { id: 'b7pD_2iE5eQ', title: 'พีชคณิตพื้นฐาน (Algebra) เข้าใจง่าย', channel: 'OrmSchool', cat: 'คณิตศาสตร์', views: '890K' },
            { id: 'C9h7k_7tqw0', title: 'ประวัติศาสตร์ไทยสมัยสุโขทัย', channel: 'Point of View', cat: 'สังคมศึกษา', views: '2.1M' },
            { id: 'M4B_8aD_9fE', title: 'Python Programming for Beginners', channel: 'Uncle Engineer', cat: 'คอมพิวเตอร์', views: '300K' },
            { id: 'rL5c5z5y5x8', title: 'เทคนิคการทำข้อสอบ GAT เชื่อมโยง', channel: 'TruePlookpanya', cat: 'แนะแนว', views: '500K' }
        ];

        // --- 2. Local/Uploaded Resources ---
        const localResources = [
            { id: 101, title: 'ใบงานเรื่องเซลล์พืช (PDF)', type: 'worksheet', cat: 'วิทยาศาสตร์', views: 120, img: 'https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=600' },
            { id: 102, title: 'Slide นำเสนอประวัติศาสตร์ (PPT)', type: 'slide', cat: 'สังคมศึกษา', views: 85, img: 'https://images.unsplash.com/photo-1461360370896-922624d12aa1?w=600' },
            { id: 103, title: 'แบบฝึกหัดท้ายบท ค21101', type: 'worksheet', cat: 'คณิตศาสตร์', views: 200, img: 'https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=600' },
            { id: 104, title: 'ข้อสอบกลางภาค (Google Form)', type: 'exam', cat: 'วัดผล', views: 350, img: 'https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=600' },
        ];

        let currentFeaturedId = '';

        // --- Functions ---

        function init() {
            refreshFeatured();
            renderGrid('all');
            initNav();
        }

        // Randomize Featured Content
        function refreshFeatured() {
            const randomIndex = Math.floor(Math.random() * onlineResources.length);
            const item = onlineResources[randomIndex];
            
            currentFeaturedId = item.id;
            
            document.getElementById('feat-title').textContent = item.title;
            document.getElementById('feat-source').textContent = `Source: ${item.channel}`;
            document.getElementById('feat-desc').textContent = `วิดีโอสื่อการสอนยอดนิยมจากช่อง ${item.channel} ในหมวดหมู่ ${item.cat} มียอดเข้าชมกว่า ${item.views} ครั้ง`;
            
            const thumbUrl = `https://img.youtube.com/vi/${item.id}/maxresdefault.jpg`;
            document.getElementById('feat-img').src = thumbUrl;
            document.getElementById('feat-bg').src = thumbUrl;

            document.getElementById('featured-content').classList.remove('hidden');
        }

        // Video Player Modal
        function playFeaturedVideo() {
            const modal = document.getElementById('video-modal');
            const frame = document.getElementById('youtube-frame');
            frame.src = `https://www.youtube.com/embed/${currentFeaturedId}?autoplay=1`;
            modal.classList.remove('hidden');
        }

        function closeVideoModal() {
            const modal = document.getElementById('video-modal');
            const frame = document.getElementById('youtube-frame');
            frame.src = ""; 
            modal.classList.add('hidden');
        }

        // Render Local Grid
        function renderGrid(filter) {
            const grid = document.getElementById('resource-grid');
            const count = document.getElementById('count-display');
            grid.innerHTML = '';

            const filteredData = localResources.filter(item => filter === 'all' || item.type === filter);
            count.textContent = filteredData.length;

            filteredData.forEach(item => {
                let iconClass = 'fa-file';
                let colorClass = 'text-gray-500';
                if(item.type === 'worksheet') { iconClass = 'fa-file-pdf'; colorClass = 'text-orange-500'; }
                if(item.type === 'slide') { iconClass = 'fa-file-powerpoint'; colorClass = 'text-red-500'; }
                if(item.type === 'exam') { iconClass = 'fa-clipboard-check'; colorClass = 'text-purple-500'; }

                grid.innerHTML += `
                    <div class="resource-card bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100 group cursor-pointer h-full flex flex-col hover:shadow-md transition">
                        <div class="relative h-40 overflow-hidden">
                            <img src="${item.img}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                            <span class="absolute top-2 right-2 bg-white/90 backdrop-blur px-2 py-1 rounded text-[10px] font-bold uppercase ${colorClass} shadow-sm">
                                <i class="fa-solid ${iconClass} mr-1"></i> ${item.type}
                            </span>
                        </div>
                        <div class="p-4 flex-1 flex flex-col justify-between">
                            <div>
                                <div class="text-xs text-brand font-bold mb-1">${item.cat}</div>
                                <h3 class="font-heading font-bold text-gray-800 text-sm leading-tight mb-2 group-hover:text-brand transition line-clamp-2">${item.title}</h3>
                            </div>
                            <div class="flex justify-between items-center pt-3 border-t border-gray-50 mt-2 text-xs text-gray-400">
                                <span><i class="fa-regular fa-eye mr-1"></i> ${item.views}</span>
                                <button class="text-gray-400 hover:text-brand bg-gray-50 p-1.5 rounded-full transition"><i class="fa-solid fa-download"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function filterContent() {
            // Simplified filter for demo
            renderGrid('all');
        }

        function filterCat(type) {
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.classList.remove('active', 'bg-gray-900', 'text-white');
                b.classList.add('bg-white', 'text-gray-600');
            });
            event.target.classList.remove('bg-white', 'text-gray-600');
            event.target.classList.add('active', 'bg-gray-900', 'text-white');
            renderGrid(type);
        }

        function toggleUploadModal() {
            const m = document.getElementById('upload-modal');
            m.classList.toggle('hidden');
        }

        // Nav Init
        function initNav() {
            const pill = document.getElementById('nav-pill');
            const activeLink = document.querySelector('.active-nav');
            if(activeLink) { pill.style.left = activeLink.offsetLeft + 'px'; pill.style.width = activeLink.offsetWidth + 'px'; }
        }
        window.addEventListener('load', initNav); window.addEventListener('resize', initNav);
        
        init();
    </script>
</body>
</html>
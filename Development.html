<!DOCTYPE html>
<html lang="th">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QJBKDWWT2P"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-QJBKDWWT2P');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Student Development</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { heading: ['Prompt', 'sans-serif'], body: ['Sarabun', 'sans-serif'] },
                    colors: { 'primary': '#0071e3', 'bg-gray': '#F5F5F7' },
                    animation: { 
                        'pulse-slow': 'pulse 3s infinite',
                        'bounce-sm': 'bounce 1s infinite'
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #F5F5F7; font-family: 'Prompt', sans-serif; -webkit-tap-highlight-color: transparent; }
        .nav-icon { transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        .active-nav .nav-icon { transform: translateY(-5px); color: #0071e3; }
        .active-nav span { color: #0071e3; font-weight: 600; }
        
        /* Glassmorphism */
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); }
        
        /* Markdown Styles */
        .prose strong { color: #0071e3; }
        .prose ul { list-style-type: disc; padding-left: 1.2em; }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
    </style>
</head>
<body class="pb-28 pt-20">

    <!-- Navbar -->
    <nav class="fixed top-0 w-full bg-white/90 backdrop-blur z-40 px-4 py-3 flex justify-between items-center h-16 border-b shadow-sm transition-all duration-300">
        <div class="flex items-center gap-3">
            <a href="Main_Dashboard.html" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition text-gray-600 active:scale-95"><i class="fa-solid fa-arrow-left"></i></a>
            <div>
                <h1 class="font-heading font-bold text-gray-800 text-lg leading-tight">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
                <p class="text-xs text-gray-500">‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏π‡πÅ‡∏•‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (SDQ)</p>
            </div>
        </div>
        <button onclick="toggleAIModal('psych')" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-3 py-1.5 rounded-full text-xs font-bold shadow hover:shadow-lg transition transform hover:scale-105 active:scale-95 flex items-center gap-2">
            <i class="fa-solid fa-user-doctor"></i> <span class="hidden sm:inline">AI ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span>
        </button>
    </nav>

    <!-- Main Content -->
    <div class="max-w-5xl mx-auto px-4">

        <!-- 1. Student Profile Selector -->
        <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex flex-col sm:flex-row items-center gap-4 mb-6 relative overflow-hidden">
            <div class="absolute top-0 right-0 w-24 h-24 bg-blue-50 rounded-full blur-2xl -mr-8 -mt-8 pointer-events-none"></div>
            
            <div class="relative flex-shrink-0">
                <img src="https://ui-avatars.com/api/?name=K+R&background=FFEDD5&color=C2410C&size=128" class="w-20 h-20 sm:w-24 sm:h-24 rounded-full border-4 border-white shadow-md">
                <div class="absolute -bottom-1 -right-1 w-6 h-6 sm:w-7 sm:h-7 bg-green-500 rounded-full border-2 border-white flex items-center justify-center text-[10px] text-white"><i class="fa-solid fa-check"></i></div>
            </div>
            
            <div class="flex-1 w-full">
                <div class="flex flex-col sm:flex-row justify-between items-center sm:items-start gap-2 mb-2">
                    <div class="text-center sm:text-left">
                        <h2 class="font-bold text-xl text-gray-800 leading-tight">‡∏î.‡∏ä. ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                        <p class="text-sm text-gray-500"><i class="fa-solid fa-id-card mr-1"></i> ID: 67001 | ‡∏ä‡∏±‡πâ‡∏ô ‡∏°.1/1</p>
                    </div>
                    <select class="text-xs sm:text-sm bg-gray-50 border border-gray-200 rounded-lg px-3 py-1.5 outline-none focus:border-primary cursor-pointer">
                        <option>‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå</option>
                        <option>‡∏°‡∏≤‡∏ô‡∏µ</option>
                    </select>
                </div>
                
                <!-- Behavior Score Bar -->
                <div class="mt-3 bg-gray-50 p-3 rounded-xl border border-gray-100">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="font-bold text-green-600">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏û‡∏§‡∏ï‡∏¥</span>
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-gray-700" id="current-score">85<span class="text-gray-400 font-normal">/100</span></span>
                            <!-- AI Parent Report Button -->
                            <button onclick="generateParentReport()" class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-[10px] hover:bg-green-200 transition flex items-center gap-1 active:scale-95">
                                <i class="fa-brands fa-line"></i> ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚ú®
                            </button>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 overflow-hidden">
                        <div id="score-bar" class="bg-gradient-to-r from-green-400 to-green-600 h-2.5 rounded-full transition-all duration-500" style="width: 85%"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <!-- 2. Behavioral Log (Interactive) -->
            <div class="bg-white rounded-2xl p-5 sm:p-6 shadow-sm border border-gray-100">
                <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-medal text-yellow-500"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°
                </h3>
                
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <button onclick="openBehaviorModal('‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤', 1, 'positive')" class="p-3 bg-green-50 border border-green-100 rounded-xl text-center hover:bg-green-100 transition active:scale-95 group">
                        <div class="text-2xl mb-1 group-hover:scale-110 transition">üßπ</div>
                        <p class="text-xs font-bold text-green-700">‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤</p>
                    </button>
                    <button onclick="openBehaviorModal('‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö', 1, 'positive')" class="p-3 bg-blue-50 border border-blue-100 rounded-xl text-center hover:bg-blue-100 transition active:scale-95 group">
                        <div class="text-2xl mb-1 group-hover:scale-110 transition">üìö</div>
                        <p class="text-xs font-bold text-blue-700">‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö</p>
                    </button>
                    <button onclick="openBehaviorModal('‡∏°‡∏≤‡∏™‡∏≤‡∏¢', -1, 'negative')" class="p-3 bg-yellow-50 border border-yellow-100 rounded-xl text-center hover:bg-yellow-100 transition active:scale-95 group">
                        <div class="text-2xl mb-1 group-hover:scale-110 transition">üèÉ</div>
                        <p class="text-xs font-bold text-yellow-700">‡∏°‡∏≤‡∏™‡∏≤‡∏¢</p>
                    </button>
                    <button onclick="openBehaviorModal('‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', -1, 'negative')" class="p-3 bg-red-50 border border-red-100 rounded-xl text-center hover:bg-red-100 transition active:scale-95 group">
                        <div class="text-2xl mb-1 group-hover:scale-110 transition">üí§</div>
                        <p class="text-xs font-bold text-red-700">‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                    </button>
                </div>

                <div class="bg-gray-50 rounded-xl p-3 border border-gray-200">
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-xs text-gray-400 font-bold uppercase">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                        <div class="flex gap-1">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            <span class="w-2 h-2 rounded-full bg-red-500"></span>
                        </div>
                    </div>
                    <ul id="behavior-log" class="space-y-2 text-sm h-32 overflow-y-auto custom-scrollbar">
                        <li class="flex justify-between items-center bg-white p-2 rounded border border-gray-100">
                            <div>
                                <span class="flex items-center gap-2 font-medium"><i class="fa-solid fa-plus-circle text-green-500"></i> ‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤ (+1)</span>
                                <p class="text-[10px] text-gray-400 pl-6">‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏ß‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                            </div>
                            <span class="text-[10px] text-gray-400">10:30</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 3. Skill Radar & Analysis -->
            <div class="bg-white rounded-2xl p-5 sm:p-6 shadow-sm border border-gray-100 flex flex-col items-center relative">
                <h3 class="font-bold text-gray-800 mb-2 w-full text-left flex justify-between items-center">
                    <span><i class="fa-solid fa-chart-radar text-purple-500 mr-2"></i> ‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞ 5 ‡∏î‡πâ‡∏≤‡∏ô</span>
                    <div class="flex gap-2">
                        <button onclick="analyzeSkills()" id="btn-skill-ai" class="text-xs bg-purple-100 text-purple-600 px-2 py-1 rounded hover:bg-purple-200 transition font-bold active:scale-95"><i class="fa-solid fa-wand-magic-sparkles"></i> AI Coach</button>
                        <button onclick="updateSkills()" class="text-xs bg-gray-100 px-2 py-1 rounded hover:bg-gray-200 active:scale-95"><i class="fa-solid fa-pen"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                    </div>
                </h3>
                <div class="w-full h-64 relative">
                    <canvas id="skillChart"></canvas>
                </div>
                
                <!-- AI Insight Area -->
                <div id="skill-insight" class="w-full mt-4 bg-purple-50 p-3 rounded-xl border border-purple-100 text-xs text-purple-800 prose prose-sm max-w-none">
                    <div class="flex items-center gap-2 font-bold mb-1"><i class="fa-solid fa-robot"></i> AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:</div>
                    <p>"‡∏î.‡∏ä. ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏î‡∏∏‡∏•"</p>
                </div>
            </div>

        </div>

        <!-- 4. Growth Timeline -->
        <div class="mt-6 bg-white rounded-2xl p-5 sm:p-6 shadow-sm border border-gray-100">
            <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-seedling text-green-500"></i> ‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
            </h3>
            <div class="relative pl-4 border-l-2 border-gray-200 space-y-6">
                <!-- Item -->
                <div class="relative group">
                    <div class="absolute -left-[21px] top-1 w-4 h-4 bg-blue-500 rounded-full border-2 border-white ring-2 ring-blue-100 group-hover:ring-blue-300 transition"></div>
                    <span class="text-[10px] text-gray-400 block mb-1">10 ‡∏™.‡∏Ñ. 67</span>
                    <div class="bg-gray-50 p-3 rounded-xl border border-gray-100 group-hover:bg-blue-50 transition">
                        <h4 class="font-bold text-sm text-gray-800">‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</h4>
                        <p class="text-xs text-gray-500 mt-1">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
                    </div>
                </div>
                <!-- Item -->
                <div class="relative group">
                    <div class="absolute -left-[21px] top-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white ring-2 ring-green-100 group-hover:ring-green-300 transition"></div>
                    <span class="text-[10px] text-gray-400 block mb-1">15 ‡∏Å.‡∏Ñ. 67</span>
                    <div class="bg-gray-50 p-3 rounded-xl border border-gray-100 group-hover:bg-green-50 transition">
                        <h4 class="font-bold text-sm text-gray-800">‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡πà‡∏≤‡∏¢‡∏≠‡∏≤‡∏™‡∏≤‡∏û‡∏±‡∏í‡∏ô‡∏≤</h4>
                        <p class="text-xs text-gray-500 mt-1">‡∏ó‡∏≤‡∏™‡∏µ‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡πâ‡∏≠‡∏á</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Behavior Modal -->
    <div id="behavior-modal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeBehaviorModal()"></div>
        <div class="bg-white w-full max-w-sm rounded-2xl shadow-2xl relative z-10 p-6 transform transition-all scale-100">
            <div class="text-center mb-4">
                <div id="modal-icon" class="text-4xl mb-2">üßπ</div>
                <h3 class="font-bold text-lg text-gray-800" id="modal-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</h3>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ)</label>
                    <div class="flex items-center gap-2">
                        <button onclick="adjustScore(-1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 font-bold active:scale-90 transition">-</button>
                        <input type="number" id="behavior-score" class="flex-1 text-center font-bold text-lg border-b-2 border-gray-200 focus:border-primary outline-none py-1" value="1">
                        <button onclick="adjustScore(1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 font-bold active:scale-90 transition">+</button>
                    </div>
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="behavior-note" rows="2" class="w-full p-3 rounded-xl border border-gray-200 bg-gray-50 text-sm focus:ring-2 focus:ring-primary outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏£‡∏π‡∏¢‡∏Å‡∏Ç‡∏≠‡∏á..."></textarea>
                </div>
                <button onclick="saveBehavior()" class="w-full bg-primary text-white py-2 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition active:scale-95">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
        </div>
    </div>

    <!-- AI Modal (Multi-Mode) -->
    <div id="ai-modal" class="fixed inset-0 z-[80] hidden flex items-center justify-center p-0 sm:p-4">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity" onclick="toggleAIModal()"></div>
        <div class="bg-white w-full h-full sm:h-auto sm:max-h-[85vh] sm:max-w-lg sm:rounded-2xl shadow-2xl relative z-10 flex flex-col overflow-hidden transition-all">
            <div class="bg-gradient-to-r from-pink-500 to-rose-500 p-4 text-white flex justify-between items-center flex-shrink-0" id="modal-header-bg">
                <h3 class="font-heading font-bold flex items-center gap-2"><i class="fa-solid fa-robot"></i> <span id="ai-modal-title">AI Assistant</span></h3>
                <button onclick="toggleAIModal()" class="hover:bg-white/20 rounded-full p-1"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <div class="p-6 overflow-y-auto space-y-4 flex-1 custom-scrollbar">
                <p class="text-sm text-gray-600" id="modal-desc">...</p>
                
                <textarea id="ai-input" rows="3" class="w-full p-3 rounded-xl border border-gray-200 text-sm focus:ring-2 focus:ring-pink-500 outline-none hidden"></textarea>
                
                <!-- Result Area -->
                <div id="ai-result" class="text-sm text-gray-700 bg-gray-50 p-4 rounded-xl hidden border border-gray-200 prose prose-sm max-w-none"></div>

                <button onclick="runAIAction()" id="btn-gen-ai" class="w-full bg-gray-900 text-white py-3 rounded-xl font-bold text-sm shadow hover:bg-black transition flex justify-center items-center gap-2 active:scale-95">
                    <i class="fa-solid fa-bolt text-yellow-400"></i> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
                </button>
            </div>
        </div>
    </div>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-xl border-t border-gray-200 px-4 py-2 md:hidden z-50 rounded-t-2xl shadow-[0_-5px_15px_rgba(0,0,0,0.05)] no-print pb-safe">
        <div class="relative flex justify-between items-center max-w-sm mx-auto">
            <div id="nav-pill" class="absolute top-1/2 -translate-y-1/2 h-10 w-12 bg-blue-50 rounded-xl transition-all duration-300 ease-out -z-10"></div>
            <a href="Main_Dashboard.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="0"><i class="fa-solid fa-house text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></a>
            <a href="LessonPlan_Manager.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="1"><i class="fa-solid fa-book-open text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£</span></a>
            <a href="Classroom_Manager.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400 active-nav" data-index="2"><i class="fa-solid fa-users text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span></a>
            <a href="Project_Manager.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="3"><i class="fa-solid fa-folder-open text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</span></a>
            <a href="TeacherPortfolio_BentoGrid.html" class="nav-item flex flex-col items-center justify-center w-12 text-gray-400" data-index="4"><i class="fa-solid fa-user text-xl mb-1 nav-icon"></i><span class="text-[9px] font-medium">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></a>
        </div>
    </nav>

    <script>
        // API Key
        const apiKey = "AIzaSyCmcCL6eAc11vaZpsFvYZwqb_zzyVPeK9o";
        let currentAIMode = '';
        let currentBehaviorTitle = '';

        // Init Chart
        const ctx = document.getElementById('skillChart').getContext('2d');
        const skillChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ', '‡∏†‡∏≤‡∏©‡∏≤', '‡∏ß‡∏¥‡∏ô‡∏±‡∏¢', '‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤'],
                datasets: [{
                    label: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞',
                    data: [85, 95, 70, 80, 60],
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    borderColor: '#3b82f6',
                    pointBackgroundColor: '#3b82f6'
                }]
            },
            options: {
                scales: { r: { suggestMin: 0, suggestMax: 100, ticks: { display: false } } },
                plugins: { legend: { display: false } },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Update Skills Manually
        function updateSkills() {
            const currentData = skillChart.data.datasets[0].data;
            const labels = skillChart.data.labels;
            
            const newDataString = prompt(`‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 5 ‡∏î‡πâ‡∏≤‡∏ô (0-100)\n(‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£, ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ, ‡∏†‡∏≤‡∏©‡∏≤, ‡∏ß‡∏¥‡∏ô‡∏±‡∏¢, ‡∏à‡∏¥‡∏ï‡∏≠‡∏≤‡∏™‡∏≤)`, currentData.join(','));
            if (newDataString) {
                const newData = newDataString.split(',').map(num => parseInt(num.trim()));
                if (newData.length === 5 && newData.every(n => !isNaN(n) && n >= 0 && n <= 100)) {
                    skillChart.data.datasets[0].data = newData;
                    skillChart.update();
                } else { alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"); }
            }
        }

        // --- Behavior Modal ---
        function openBehaviorModal(title, defaultScore, type) {
            currentBehaviorTitle = title;
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-icon').innerText = type === 'positive' ? 'üòä' : 'üòì';
            document.getElementById('behavior-score').value = defaultScore;
            document.getElementById('behavior-note').value = '';
            
            const scoreInput = document.getElementById('behavior-score');
            if(defaultScore > 0) scoreInput.className = "flex-1 text-center font-bold text-lg border-b-2 border-green-200 focus:border-green-500 outline-none py-1 text-green-600";
            else scoreInput.className = "flex-1 text-center font-bold text-lg border-b-2 border-red-200 focus:border-red-500 outline-none py-1 text-red-600";

            document.getElementById('behavior-modal').classList.remove('hidden');
        }

        function closeBehaviorModal() {
            document.getElementById('behavior-modal').classList.add('hidden');
        }

        function adjustScore(amount) {
            const input = document.getElementById('behavior-score');
            input.value = parseInt(input.value) + amount;
        }

        function saveBehavior() {
            const score = parseInt(document.getElementById('behavior-score').value);
            const note = document.getElementById('behavior-note').value;
            const title = currentBehaviorTitle;
            
            const list = document.getElementById('behavior-log');
            const item = document.createElement('li');
            item.className = "flex justify-between items-center bg-white p-2 rounded border border-gray-100 animate-pulse";
            const icon = score > 0 ? '<i class="fa-solid fa-plus-circle text-green-500"></i>' : '<i class="fa-solid fa-minus-circle text-red-500"></i>';
            const noteText = note ? `<p class="text-[10px] text-gray-400 pl-6 truncate w-32">${note}</p>` : '';
            
            item.innerHTML = `
                <div>
                    <span class="flex items-center gap-2 font-medium text-sm">${icon} ${title} (${score > 0 ? '+' : ''}${score})</span>
                    ${noteText}
                </div>
                <span class="text-[10px] text-gray-400">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</span>
            `;
            list.insertBefore(item, list.firstChild);
            
            const currentTotalEl = document.getElementById('current-score');
            let newTotal = parseInt(currentTotalEl.innerText) + score;
            if(newTotal > 100) newTotal = 100; if(newTotal < 0) newTotal = 0;
            currentTotalEl.innerText = newTotal;
            document.getElementById('score-bar').style.width = `${newTotal}%`;

            closeBehaviorModal();
            setTimeout(() => item.classList.remove('animate-pulse'), 500);
        }

        // --- AI Features ---
        function toggleAIModal(mode) {
            const modal = document.getElementById('ai-modal');
            const input = document.getElementById('ai-input');
            const result = document.getElementById('ai-result');
            const title = document.getElementById('ai-modal-title');
            const desc = document.getElementById('modal-desc');
            const header = document.getElementById('modal-header-bg');
            const btn = document.getElementById('btn-gen-ai');

            currentAIMode = mode || 'psych';
            result.classList.add('hidden'); result.innerHTML = '';
            
            if (currentAIMode === 'psych') {
                title.textContent = 'AI Psychologist';
                desc.textContent = '‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö';
                header.className = 'bg-gradient-to-r from-pink-500 to-rose-500 p-4 text-white flex justify-between items-center flex-shrink-0 safe-top-padding';
                input.classList.remove('hidden'); input.value = '';
                btn.innerHTML = '<i class="fa-solid fa-heart-pulse"></i> ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥';
            } else if (currentAIMode === 'report') {
                title.textContent = 'AI Parent Reporter';
                desc.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á...';
                header.className = 'bg-gradient-to-r from-green-500 to-teal-500 p-4 text-white flex justify-between items-center flex-shrink-0 safe-top-padding';
                input.classList.add('hidden');
                btn.innerHTML = '<i class="fa-brands fa-line"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°';
            }
            modal.classList.toggle('hidden');
        }

        function generateParentReport() { toggleAIModal('report'); }
        
        async function analyzeSkills() {
            const btn = document.getElementById('btn-skill-ai');
            const resArea = document.getElementById('skill-insight');
            const data = skillChart.data.datasets[0].data;
            const labels = skillChart.data.labels;
            
            btn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i> ...';
            
            const skillContext = labels.map((l, i) => `${l} ${data[i]}`).join(', ');
            const prompt = `‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏∏‡∏î‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏°‡∏£‡∏£‡∏ñ‡∏ô‡∏∞: ${skillContext} (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° 100) \n‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ 1 ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏î‡πâ";
                
                resArea.innerHTML = `<div class="flex items-center gap-2 font-bold mb-1 text-green-700"><i class="fa-solid fa-wand-magic-sparkles"></i> AI Coach Suggestion:</div><p>${text}</p>`;
            } catch(e) { console.error(e); }
            
            btn.innerHTML = '<i class="fa-solid fa-wand-magic-sparkles"></i> AI Coach';
        }

        async function runAIAction() {
            const inputVal = document.getElementById('ai-input').value;
            const resArea = document.getElementById('ai-result');
            const btn = document.getElementById('btn-gen-ai');
            
            if (currentAIMode === 'psych' && !inputVal) return;

            btn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...';
            resArea.classList.remove('hidden');
            
            let prompt = "";
            if (currentAIMode === 'psych') {
                prompt = `‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏∞‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏£‡∏π‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: "${inputVal}" \n1. ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ \n2. ‡∏ß‡∏¥‡∏ò‡∏µ‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡πá‡∏Å (Positive scripts) \n3. ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ñ‡∏∂‡∏á‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á`;
            } else if (currentAIMode === 'report') {
                const score = document.getElementById('current-score').innerText.split('/')[0];
                prompt = `‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏á‡πÑ‡∏•‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${score}/100 ‡∏™‡∏∏‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå`;
            }

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text || "Error";
                resArea.innerHTML = marked.parse(text);
            } catch(e) { resArea.innerHTML = "AI Error"; }

            btn.innerHTML = '<i class="fa-solid fa-check"></i> ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô';
        }

        // Nav Init
        function initNav() {
            const pill = document.getElementById('nav-pill');
            const activeLink = document.querySelector('.active-nav');
            if(activeLink) { pill.style.left = activeLink.offsetLeft + 'px'; pill.style.width = activeLink.offsetWidth + 'px'; }
        }
        window.addEventListener('load', initNav); window.addEventListener('resize', initNav);
    </script>
</body>
</html>